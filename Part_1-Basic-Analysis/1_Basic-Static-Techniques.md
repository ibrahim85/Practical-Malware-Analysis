#### 1. Basic Static Techniques

- Antivirus Scanning
	- [VirusTotal](https://www.virustotal.com)
	
- Hashing

	```sh
	C:\Users\Win7-32>md5deep.exe key_checker.exe
	61acb0bb5ff94d62c215096585a06c66 key_checker.exe
	C:\Users\Win7-32>
	```
- Strings

	```sh
	C:\Users\Win7-32>strings.exe key_checker.exe
	```
	
	- Unicode ~ Microsoft's Wide Character
	- ASCII strings = 1 byte per character
	- Unicode string = 2 bytes per character

	![Image of ASCII](images/1.jpeg)
	
	![Image of UNICODE](images/2.jpeg)
	
- Packed and Obfuscated Malware

![Image of UNICODE](images/3.jpeg)

```sh
C:\Users\Win7-32\Desktop\upx394w>upx.exe
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2017
UPX 3.94w       Markus Oberhumer, Laszlo Molnar & John Reiser   May 12th 2017

Usage: upx [-123456789dlthVL] [-qvfk] [-o file] file..

Commands:
  -1     compress faster                   -9    compress better
  -d     decompress                        -l    list compressed file
  -t     test compressed file              -V    display version number
  -h     give more help                    -L    display software license
Options:
  -q     be quiet                          -v    be verbose
  -oFILE write output to 'FILE'
  -f     force compression of suspicious files
  -k     keep backup files
file..   executables to (de)compress

Type 'upx --help' for more detailed help.

UPX comes with ABSOLUTELY NO WARRANTY; for details visit https://upx.github.io

C:\Users\Win7-32\Desktop\upx394w>
```

```sh
C:\Users\Win7-32\Desktop\upx394w>upx.exe -1 Lab01-01.exe -o Lab_compress.exe
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2017
UPX 3.94w       Markus Oberhumer, Laszlo Molnar & John Reiser   May 12th 2017

        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
     16384 ->      4608   28.13%    win32/pe     Lab_compress.exe

Packed 1 file.

C:\Users\Win7-32\Desktop\upx394w
```

![Image of UPX](images/5.jpeg)

```sh
C:\Users\Win7-32\Desktop\upx394w>upx.exe -d Lab_compress.exe -o Lab_decompress.exe
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2017
UPX 3.94w       Markus Oberhumer, Laszlo Molnar & John Reiser   May 12th 2017

        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
     16384 <-      4608   28.13%    win32/pe     Lab_decompress.exe

Unpacked 1 file.

C:\Users\Win7-32\Desktop\upx394w>
```

![Image of UPX](images/4.jpeg)

###### PE File Format

- Windows executables
- object code
- DLLs

![Image of PE](images/PE.png)

- ```Imports``` are functions used by one program that are actually stored in a different program, such as code libraries that contain functionality common to many programs. 
- Code libraries can be connected to the main executable by ```linking```.
	- ```Static Linking```
		- When a library is statically linked to an executable, all code from that library is copied into the executable, which makes the executable grow in size.
	- ```Runtime Linking```
		- Executables that use runtime linking connect to libraries only when that function is needed, not at program start
		- ```LoadLibrary```, ```GetProcAddress```, ```LdrGetProcAddress```, ```LdrLoadDll``` allow a program to access any function in any library on the system
	- ```Dynamic Linking```
		- When libraries are dynamically linked, the host OS searches for the necessary libraries when the program is loaded. When the program calls the linked library function, that function executes within the library.
		- View dynamically linked libraries
		![Image of PE](images/6.jpeg)
		


